export function generateMbtiLongDescription(typeCode: string, title?: string): string {
  const t = (typeCode || '').toUpperCase();
  const [a, b, c, d] = [t[0], t[1], t[2], t[3]];

  const lead = (titleStr: string) =>
    `Этот профиль — ${titleStr ? `«${titleStr}»` : 'ваш тип личности'} (${t}). Описание основано на четырёх предпочтениях MBTI и отражает естественные способы получать энергию, собирать информацию, принимать решения и организовывать жизнь.`;

  const mapE = {
    E: 'Вы черпаете энергию во внешнем мире: через взаимодействие, обмен идеями, практику и действие. Вам легче мыслить вслух, быстро включаться в диалог и вдохновлять других. Среда с живым общением и динамикой помогает поддерживать высокий уровень мотивации.',
    I: 'Вы черпаете энергию из внутреннего мира: через размышления, концентрацию и уединение. Вам комфортно обдумывать идеи прежде, чем делиться ими, и углубляться в суть задач. Среда с пространством для фокуса и независимой работы усиливает вашу продуктивность.'
  } as const;

  const mapS = {
    S: 'В обработке информации вы опираетесь на факты, конкретику и проверенный опыт. Любите ясность требований, пошаговые планы и наблюдаемые результаты. Сильны там, где важны точность, надёжность и работа с реальными данными и процессами.',
    N: 'В обработке информации вы ориентированы на возможности, связи и смыслы. Вас привлекают идеи, модели и обобщения. Сильны там, где нужно видение, инновации и поиск нестандартных ходов, особенно в условиях неопределённости.'
  } as const;

  const mapT = {
    T: 'В принятии решений вы стремитесь к логике и объективным критериям. Цените справедливость, ясные правила и измеримые результаты. Умеете отделять главное от второстепенного, трезво оценивать риски и выстраивать рациональные аргументы.',
    F: 'В принятии решений вы учитываете ценности и влияние на людей. Цените атмосферу доверия, эмпатию и сотрудничество. Сильны в поддержке, согласовании и создании смыслов, которые объединяют команду и клиентов.'
  } as const;

  const mapJ = {
    J: 'В организации жизни вам близки структура, определённость и завершённость. Предпочитаете планировать, фиксировать сроки, двигаться по этапам и доводить дела до результата. Последовательность и ответственность — ваши сильные стороны.',
    P: 'В организации жизни вам близки гибкость, адаптивность и открытые варианты. Предпочитаете оставлять пространство для новых возможностей, быстро переключаться и импровизировать. Сильны в изменчивой среде и задачах, требующих оперативных решений.'
  } as const;

  const synergy = (a: string, b: string, c: string, d: string) => {
    const strengths: Record<string, string> = {
      E: 'коммуникация, влияние, обучение через действие',
      I: 'углубление, концентрация, продуманные решения',
      S: 'реализм, точность, работа с процессами',
      N: 'видение, креативность, стратегическое мышление',
      T: 'анализ, логика, объективность',
      F: 'эмпатия, доверие, кооперация',
      J: 'дисциплина, планирование, завершение',
      P: 'адаптивность, вариативность, быстрота реакции'
    };
    return `Сочетание предпочтений формирует уникальный стиль: ${strengths[a]} · ${strengths[b]} · ${strengths[c]} · ${strengths[d]}. Развивайте баланс — добавляйте практики противоположных полюсов, чтобы расширять поведенческий репертуар без потери сильных сторон.`;
  };

  const careers = (t: string) => {
    const recs: Record<string, string> = {
      NT: 'аналитика, стратегия, продукт, исследование, архитектура систем',
      NF: 'обучение, коммуникации, брендинг, сервис, развитие людей',
      SJ: 'операционное управление, финансы, compliance, проектирование процессов',
      SP: 'сфера событий, продажи, антикризис, креативные и практические роли'
    };
    const pair = `${t[1]}${t[2]}`;
    const key = (pair === 'NT' || pair === 'NF') ? pair : (t[1] === 'S' && (t[3] === 'J' ? 'SJ' : 'SP')) as 'SJ' | 'SP';
    return `Подходящие роли и среды: ${recs[key]}. Выбирайте команды и проекты, где ваши естественные предпочтения превращаются в результат.`;
  };

  const titleStr = title || '';
  const parts = [
    lead(titleStr),
    mapE[a as 'E' | 'I'],
    mapS[b as 'S' | 'N'],
    mapT[c as 'T' | 'F'],
    mapJ[d as 'J' | 'P'],
    synergy(a, b, c, d),
    careers(t)
  ];

  return parts.join(' ');
}










